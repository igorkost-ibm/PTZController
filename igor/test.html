<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keyboard Catcher</title>
</head>
<body>
    <div id="app">
        <p>Keyboard PTZ:</p>
        <p id="key"></p>
        <p id="fun"></p>
    </div>

    <script>
        const base = 'http://192.168.0.101/cgi-bin/rpcCommon.cgi?fun='

        function makeGetRequest(apiUrl) {
            console.log("GET: " + apiUrl)

            // Use the fetch API to make a GET request
            fetch(apiUrl, { mode: 'no-cors' })
                .then(response => response.text())
                .then(data => {
                    // Handle the response data
                    console.log(data);
                })
                .catch(error => {
                    // Handle errors
                    // console.error('Error:', error);
                });
        }

        var stringMap = {
            "ArrowLeft": "moveLeft",
            "ArrowRight": "moveRight",
            "ArrowUp": "moveUp",
            "ArrowDown": "moveDown",
        };

        function keydown(event) {
            document.removeEventListener('keydown', keydown);

            const key = event.key;
            document.getElementById('key').textContent = `key: ${key}`;

            var fun = stringMap[key]
            document.getElementById('fun').textContent = `fun: ${fun}`;

            console.log(fun)
            if (fun == null) {
                console.log('undefined key')
            } else {
                var url = base + fun + "&par=10";
                makeGetRequest(url);
            }
        }

        function keyup(event) {
            const key = event.key;
            document.getElementById('key').textContent = `key:`;
            document.getElementById('fun').textContent = `fun:`;

            var url = base + "moveStop&par=NULL";
            makeGetRequest(url);

            document.addEventListener('keydown', keydown);
        }

        document.addEventListener('keydown', keydown);
        document.addEventListener('keyup', keyup);
    </script>
</body>
</html>